!function(t){"function"==typeof define&&define.amd?define("object"!=typeof document||"loading"!==document.readyState?[]:"html5-history-api",t):t()}(function(){function t(){}function e(t,n,i){var r=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/;if(null==t||""===t||n)t=n?t:P.href,(!S||i)&&(t=t.replace(/^[^#]*/,"")||"#",t=P.protocol.replace(/:.*$|$/,":")+"//"+P.host+$.basepath+t.replace(new RegExp("^#[/]?(?:"+$.type+")?"),""));else{var o=e(),a=y.getElementsByTagName("base")[0];!i&&a&&a.getAttribute("href")&&(a.href=a.href,o=e(a.href,null,!0));var s=o._pathname,l=o._protocol;t=""+t,t=/^(?:\w+\:)?\/\//.test(t)?0===t.indexOf("/")?l+t:t:l+"//"+o._host+(0===t.indexOf("/")?t:0===t.indexOf("?")?s+t:0===t.indexOf("#")?s+o._search+t:s.replace(/[^\/]+$/g,"")+t)}M.href=t;var c=r.exec(M.href),f=c[2]+(c[3]?":"+c[3]:""),p=c[4]||"/",h=c[5]||"",u="#"===c[6]?"":c[6]||"",d=p+h+u,g=p.replace(new RegExp("^"+$.basepath,"i"),$.type)+h;return{_href:c[1]+"//"+f+d,_protocol:c[1],_host:f,_hostname:c[2],_port:c[3]||"",_pathname:p,_search:h,_hash:u,_relative:d,_nohash:g,_special:g+u}}function n(){var t;try{t=m.sessionStorage,t.setItem(B+"t","1"),t.removeItem(B+"t")}catch(e){t={getItem:function(t){var e=y.cookie.split(t+"=");return e.length>1&&e.pop().split(";").shift()||"null"},setItem:function(t,e){var n={};(n[P.href]=E.state)&&(y.cookie=t+"="+w.stringify(n))}}}try{J=w.parse(t.getItem(B))||{}}catch(e){J={}}A(N+"unload",function(){t.setItem(B,w.stringify(J))},!1)}function i(e,n,i,r){var o=0;i||(i={set:t},o=1);var a=!i.set,s=!i.get,l={configurable:!0,set:function(){a=1},get:function(){s=1}};try{T(e,n,l),e[n]=e[n],T(e,n,i)}catch(c){}if(!(a&&s||(e.__defineGetter__&&(e.__defineGetter__(n,l.get),e.__defineSetter__(n,l.set),e[n]=e[n],i.get&&e.__defineGetter__(n,i.get),i.set&&e.__defineSetter__(n,i.set)),a&&s))){if(o)return!1;if(e===m){try{var f=e[n];e[n]=null}catch(c){}if("execScript"in m)m.execScript("Public "+n,"VBScript"),m.execScript("var "+n+";","JavaScript");else try{T(e,n,{value:t})}catch(c){"onpopstate"===n&&(A("popstate",i=function(){C("popstate",i,!1);var t=e.onpopstate;e.onpopstate=null,setTimeout(function(){e.onpopstate=t},1)},!1),V=0)}e[n]=f}else try{try{var p=_.create(e);T(_.getPrototypeOf(p)===e?p:e,n,i);for(var h in e)"function"==typeof e[h]&&(p[h]=e[h].bind(e));try{r.call(p,p,e)}catch(c){}e=p}catch(c){T(e.constructor.prototype,n,i)}}catch(c){return!1}}return e}function r(t,e,n){return n=n||{},t=t===Y?P:t,n.set=n.set||function(n){t[e]=n},n.get=n.get||function(){return t[e]},n}function o(t,e,n){t in Q?Q[t].push(e):arguments.length>3?A(t,e,n,arguments[3]):A(t,e,n)}function a(t,e,n){var i=Q[t];if(i){for(var r=i.length;r--;)if(i[r]===e){i.splice(r,1);break}}else C(t,e,n)}function s(e,n){var r=(""+("string"==typeof e?e:e.type)).replace(/^on/,""),o=Q[r];if(o){if(n="string"==typeof e?n:e,null==n.target)for(var a=["target","currentTarget","srcElement","type"];e=a.pop();)n=i(n,e,{get:"type"===e?function(){return r}:function(){return m}});V&&(("popstate"===r?m.onpopstate:m.onhashchange)||t).call(m,n);for(var s=0,l=o.length;l>s;s++)o[s].call(m,n);return!0}return G(e,n)}function l(){var t=y.createEvent?y.createEvent("Event"):y.createEventObject();t.initEvent?t.initEvent("popstate",!1,!1):t.type="popstate",t.state=E.state,s(t)}function c(){U&&(U=!1,l())}function f(t,n,i,r){if(S)q=P.href;else{0===F&&(F=2);var o=e(n,2===F&&-1!==(""+n).indexOf("#"));o._relative!==e()._relative&&(q=r,i?P.replace("#"+o._special):P.hash=o._special)}!k&&t&&(J[P.href]=t),U=!1}function p(t){var n=q;if(q=P.href,n){z!==P.href&&l(),t=t||m.event;var i=e(n,!0),r=e();t.oldURL||(t.oldURL=i._href,t.newURL=r._href),i._hash!==r._hash&&s(t)}}function h(t){setTimeout(function(){A("popstate",function(t){z=P.href,k||(t=i(t,"state",{get:function(){return E.state}})),s(t)},!1)},0),!S&&t!==!0&&"location"in E&&(g(j.hash),c())}function u(t){for(;t;){if("A"===t.nodeName)return t;t=t.parentNode}}function d(t){var n=t||m.event,i=u(n.target||n.srcElement),r="defaultPrevented"in n?n.defaultPrevented:n.returnValue===!1;if(i&&"A"===i.nodeName&&!r){var o=e(),a=e(i.getAttribute("href",2)),s=o._href.split("#").shift()===a._href.split("#").shift();s&&a._hash&&(o._hash!==a._hash&&(j.hash=a._hash),g(a._hash),n.preventDefault?n.preventDefault():n.returnValue=!1)}}function g(t){var e=y.getElementById(t=(t||"").replace(/^#/,""));if(e&&e.id===t&&"A"===e.nodeName){var n=e.getBoundingClientRect();m.scrollTo(x.scrollLeft||0,n.top+(x.scrollTop||0)-(x.clientTop||0))}}function v(){var t=y.getElementsByTagName("script"),o=(t[t.length-1]||{}).src||"",a=-1!==o.indexOf("?")?o.split("?").pop():"";a.replace(/(\w+)(?:=([^&]*))?/g,function(t,e,n){$[e]=(n||"").replace(/^(0|false)$/,"")}),A(N+"hashchange",p,!1);var s=[Y,j,X,m,W,E];k&&delete W.state;for(var l=0;l<s.length;l+=2)for(var c in s[l])if(s[l].hasOwnProperty(c))if("function"==typeof s[l][c])s[l+1][c]=s[l][c];else{var f=r(s[l],c,s[l][c]);if(!i(s[l+1],c,f,function(t,e){e===E&&(m.history=E=s[l+1]=t)}))return C(N+"hashchange",p,!1),!1;s[l+1]===m&&(Q[c]=Q[c.substr(2)]=[])}return E.setup(),$.redirect&&E.redirect(),$.init&&(F=1),!k&&w&&n(),S||y[D](N+"click",d,!1),"complete"===y.readyState?h(!0):(S||e()._relative===$.basepath||(U=!0),A(N+"load",h,!1)),!0}var m=("object"==typeof window?window:this)||{};if(!m.history||"emulate"in m.history)return m.history;var y=m.document,x=y.documentElement,_=m.Object,w=m.JSON,P=m.location,b=m.history,E=b,L=b.pushState,O=b.replaceState,S=!!L,k="state"in b,T=_.defineProperty,j=i({},"t")?{}:y.createElement("a"),N="",D=m.addEventListener?"addEventListener":(N="on")&&"attachEvent",I=m.removeEventListener?"removeEventListener":"detachEvent",R=m.dispatchEvent?"dispatchEvent":"fireEvent",A=m[D],C=m[I],G=m[R],$={basepath:"/",redirect:0,type:"/",init:0},B="__historyAPI__",M=y.createElement("a"),q=P.href,z="",V=1,U=!1,F=0,J={},Q={},H=y.title,X={onhashchange:null,onpopstate:null},K=function(t,e){var n=m.history!==b;n&&(m.history=b),t.apply(b,e),n&&(m.history=E)},W={setup:function(t,e,n){$.basepath=(""+(null==t?$.basepath:t)).replace(/(?:^|\/)[^\/]*$/,"/"),$.type=null==e?$.type:e,$.redirect=null==n?$.redirect:!!n},redirect:function(t,n){if(E.setup(n,t),n=$.basepath,m.top==m.self){var i=e(null,!1,!0)._relative,r=P.pathname+P.search;S?(r=r.replace(/([^\/])$/,"$1/"),i!=n&&new RegExp("^"+n+"$","i").test(r)&&P.replace(i)):r!=n&&(r=r.replace(/([^\/])\?/,"$1/?"),new RegExp("^"+n,"i").test(r)&&P.replace(n+"#"+r.replace(new RegExp("^"+n,"i"),$.type)+P.hash))}},pushState:function(t,e,n){var i=y.title;null!=H&&(y.title=H),L&&K(L,arguments),f(t,n),y.title=i,H=e},replaceState:function(t,e,n){var i=y.title;null!=H&&(y.title=H),delete J[P.href],O&&K(O,arguments),f(t,n,!0),y.title=i,H=e},location:{set:function(t){0===F&&(F=1),m.location=t},get:function(){return 0===F&&(F=1),S?P:j}},state:{get:function(){return J[P.href]||null}}},Y={assign:function(t){0===(""+t).indexOf("#")?f(null,t):P.assign(t)},reload:function(){P.reload()},replace:function(t){0===(""+t).indexOf("#")?f(null,t,!0):P.replace(t)},toString:function(){return this.href},href:{get:function(){return e()._href}},protocol:null,host:null,hostname:null,port:null,pathname:{get:function(){return e()._pathname}},search:{get:function(){return e()._search}},hash:{set:function(t){f(null,(""+t).replace(/^(#|)/,"#"),!1,q)},get:function(){return e()._hash}}};return v()?(E.emulate=!S,m[D]=o,m[I]=a,m[R]=s,E):void 0}),function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Spinner=e()}(this,function(){"use strict";function t(t,e){var n,i=document.createElement(t||"div");for(n in e)i[n]=e[n];return i}function e(t){for(var e=1,n=arguments.length;n>e;e++)t.appendChild(arguments[e]);return t}function n(t,e,n,i){var r=["opacity",e,~~(100*t),n,i].join("-"),o=.01+n/i*100,a=Math.max(1-(1-t)/e*(100-o),t),s=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return p[r]||(h.insertRule("@"+l+"keyframes "+r+"{0%{opacity:"+a+"}"+o+"%{opacity:"+t+"}"+(o+.01)+"%{opacity:1}"+(o+e)%100+"%{opacity:"+t+"}100%{opacity:"+a+"}}",h.cssRules.length),p[r]=1),r}function i(t,e){var n,i,r=t.style;for(e=e.charAt(0).toUpperCase()+e.slice(1),i=0;i<f.length;i++)if(n=f[i]+e,void 0!==r[n])return n;return void 0!==r[e]?e:void 0}function r(t,e){for(var n in e)t.style[i(t,n)||n]=e[n];return t}function o(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)void 0===t[i]&&(t[i]=n[i])}return t}function a(t,e){return"string"==typeof t?t:t[e%t.length]}function s(t){this.opts=o(t||{},s.defaults,u)}function l(){function n(e,n){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}h.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(t,i){function o(){return r(n("group",{coordsize:f+" "+f,coordorigin:-c+" "+-c}),{width:f,height:f})}function s(t,s,l){e(h,e(r(o(),{rotation:360/i.lines*t+"deg",left:~~s}),e(r(n("roundrect",{arcsize:i.corners}),{width:c,height:i.width,left:i.radius,top:-i.width>>1,filter:l}),n("fill",{color:a(i.color,t),opacity:i.opacity}),n("stroke",{opacity:0}))))}var l,c=i.length+i.width,f=2*c,p=2*-(i.width+i.length)+"px",h=r(o(),{position:"absolute",top:p,left:p});if(i.shadow)for(l=1;l<=i.lines;l++)s(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=i.lines;l++)s(l);return e(t,h)},s.prototype.opacity=function(t,e,n,i){var r=t.firstChild;i=i.shadow&&i.lines||0,r&&e+i<r.childNodes.length&&(r=r.childNodes[e+i],r=r&&r.firstChild,r=r&&r.firstChild,r&&(r.opacity=n))}}var c,f=["webkit","Moz","ms","O"],p={},h=function(){var n=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),u={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};s.defaults={},o(s.prototype,{spin:function(e){this.stop();var n=this,i=n.opts,o=n.el=r(t(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex});if(r(o,{left:i.left,top:i.top}),e&&e.insertBefore(o,e.firstChild||null),o.setAttribute("role","progressbar"),n.lines(o,n.opts),!c){var a,s=0,l=(i.lines-1)*(1-i.direction)/2,f=i.fps,p=f/i.speed,h=(1-i.opacity)/(p*i.trail/100),u=p/i.lines;!function d(){s++;for(var t=0;t<i.lines;t++)a=Math.max(1-(s+(i.lines-t)*u)%p*h,i.opacity),n.opacity(o,t*i.direction+l,a,i);n.timeout=n.el&&setTimeout(d,~~(1e3/f))}()}return n},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(i,o){function s(e,n){return r(t(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*f+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var l,f=0,p=(o.lines-1)*(1-o.direction)/2;f<o.lines;f++)l=r(t(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:c&&n(o.opacity,o.trail,p+f*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&e(l,r(s("#000","0 0 4px #000"),{top:"2px"})),e(i,e(l,s(a(o.color,f),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(t,e,n){e<t.childNodes.length&&(t.childNodes[e].style.opacity=n)}});var d=r(t("group"),{behavior:"url(#default#VML)"});return!i(d,"transform")&&d.adj?l():c=i(d,"animation"),s}),function(t){if("object"==typeof exports)t(require("jquery"),require("spin.js"));else if("function"==typeof define&&define.amd)define(["jquery","spin"],t);else{if(!window.Spinner)throw new Error("Spin.js not present");t(window.jQuery,window.Spinner)}}(function(t,e){t.fn.spin=function(n,i){return this.each(function(){var r=t(this),o=r.data();o.spinner&&(o.spinner.stop(),delete o.spinner),n!==!1&&(n=t.extend({color:i||r.css("color")},t.fn.spin.presets[n]||n),o.spinner=new e(n).spin(this))})},t.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}});var PG8={};(function(t,e,n,i){"use strict";if("undefined"!=typeof PG8Data){var r=n.history.location||n.location,o=this.PageLoader=function(e){this.thisLink=r.href,this.nextLink=PG8Data.nextLink,this.thisPage=parseInt(PG8Data.startPage,10),this.nextPage=this.thisPage+1,this.maxPages=parseInt(PG8Data.maxPages,10),this.maxedOut=0,this.opts=t.extend({},t.fn.ajaxPageLoader.defaults,e),this.content=t(this.opts.content),this.nextPage<=this.maxPages&&this.init()};o.prototype={init:function(){this.content.children().wrapAll('<div id="content-page-'+this.thisPage+'" class="clear" data-href="'+this.thisLink+'"></div>'),this.holder(),this.handler(),this.spinner()},holder:function(){this.content.append('<div id="content-page-'+this.nextPage+'" class="clear" data-href="'+this.nextLink+'"></div>')},handler:function(){var i=this,r=t(n);t("body").on("click",i.opts.next,function(e){i.nextPage<=i.maxPages&&(e.preventDefault(),t(this).parents("nav:first").before(t("#spinner").show()),i.loader(i.nextPage,i.nextLink))}),r.on("scroll",this.content,function(n){clearTimeout(t.data(this,"pushTimer")),clearTimeout(t.data(this,"infinTimer")),t.data(this,"pushTimer",setTimeout(function(){var e=i.content.children(":first"),n=e.offset().top,o=e.data("href"),a=r.scrollTop();n>=a?i.pusher(o):i.content.children().each(function(){var e=t(this),n=e.offset().top-i.opts.scrollOffset,r=e.outerHeight()+n;a>=n&&r>a&&i.pusher(e.data("href"))})},i.opts.pushDelay)),0===i.maxedOut&&i.opts.infinScroll===!0&&t.data(this,"infinTimer",setTimeout(function(){var n=t(e),o=n.height(),a=r.height()+r.scrollTop(),s=i.content.children(":last").offset().top,l=o-a;a>s+i.opts.scrollOffset&&a<=s+i.opts.scrollOffset+i.opts.infinOffset&&l>=i.opts.infinFooter&&t(i.opts.next).trigger("click")},i.opts.infinDelay))})},spinner:function(){t.isFunction(n.Spinner)&&(this.content.after('<div id="spinner" style="position: relative;"></div>'),t("#spinner").spin(this.opts.spinOpts).hide())},pusher:function(t){"undefined"!=typeof t&&t!==r.href&&history.pushState(null,null,t)},loader:function(e,n){var i=this;t("#content-page-"+e).load(n+" "+i.opts.content+" > *",function(){var o=t(i.opts.next);i.thisPage=e,i.thisLink=n,i.nextPage=e+1,i.nextLink=n.replace(/\/page\/[0-9]*/,"/page/"+i.nextPage),i.pusher(i.thisLink),i.holder(),i.nextPage>i.maxPages?(o.remove(),i.maxedOut=1):o.is("[href]")?o.attr("href",i.nextLink):t("[href]",o).attr("href",i.nextLink),t("#spinner").hide(),t(i.opts.prev).hide(),i.loaded(),i.scroll(),i.analytics("/"+r.href.replace(i.root(),""))})},loaded:function(){var t=e.createEvent("Event");t.initEvent("DOMContentLoaded",!0,!0),n.document.dispatchEvent(t)},scroll:function(){var e=t("#content-page-"+this.thisPage).children(":first").offset().top-this.opts.scrollOffset;t("body, html").animate({scrollTop:e},this.opts.scrollDelay,"swing")},analytics:function(t){"undefined"!=typeof n.ga?n.ga("send","pageview",t):"undefined"!=typeof n._gaq&&n._gaq.push(["_trackPageview",t])},root:function(){var t=e.location.port?":"+e.location.port:"",n=e.location.protocol+"//"+(e.location.hostname||e.location.host)+t+"/";return n}},t.fn.ajaxPageLoader=function(e){return this.each(function(){t.data(this,"ajaxPageLoader")||t.data(this,"ajaxPageLoader",new o(e))})},t.fn.ajaxPageLoader.defaults={content:"main",next:".next-page",prev:".prev-page",scrollDelay:300,scrollOffset:30,pushDelay:250,infinScroll:!0,infinDelay:600,infinOffset:300,infinFooter:1,spinOpts:{lines:25,length:0,width:4,radius:25,speed:1.5,trail:40,top:"15px"}}}}).apply(PG8,[jQuery,document,window]);